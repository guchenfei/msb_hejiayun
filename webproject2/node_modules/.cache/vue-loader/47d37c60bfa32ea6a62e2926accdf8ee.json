{"remainingRequest":"E:\\ideas-test\\webproject\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\ideas-test\\webproject\\src\\components\\CountDown\\CountDown.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\ideas-test\\webproject\\src\\components\\CountDown\\CountDown.vue","mtime":1587193626000},{"path":"E:\\ideas-test\\webproject\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1655196103443},{"path":"E:\\ideas-test\\webproject\\node_modules\\babel-loader\\lib\\index.js","mtime":1655196104199},{"path":"E:\\ideas-test\\webproject\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1655196103443},{"path":"E:\\ideas-test\\webproject\\node_modules\\vue-loader\\lib\\index.js","mtime":1655196105141}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KDQpmdW5jdGlvbiBmaXhlZFplcm8odmFsKSB7DQogICAgcmV0dXJuIHZhbCAqIDEgPCAxMCA/IGAwJHt2YWx9YCA6IHZhbA0KfQ0KDQpleHBvcnQgZGVmYXVsdCB7DQogICAgbmFtZTogJ0NvdW50RG93bicsDQogICAgcHJvcHM6IHsNCiAgICAgICAgZm9ybWF0OiB7DQogICAgICAgICAgICB0eXBlOiBGdW5jdGlvbiwNCiAgICAgICAgICAgIGRlZmF1bHQ6IHVuZGVmaW5lZA0KICAgICAgICB9LA0KICAgICAgICB0YXJnZXQ6IHsNCiAgICAgICAgICAgIHR5cGU6IFtEYXRlLCBOdW1iZXJdLA0KICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUNCiAgICAgICAgfSwNCiAgICAgICAgb25FbmQ6IHsNCiAgICAgICAgICAgIHR5cGU6IEZ1bmN0aW9uLA0KICAgICAgICAgICAgZGVmYXVsdDogKCkgPT4gKHt9KQ0KICAgICAgICB9DQogICAgfSwNCiAgICBkYXRhKCkgew0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgZGF0ZVRpbWU6ICcwJywNCiAgICAgICAgICAgIG9yaWdpblRhcmdldFRpbWU6IDAsDQogICAgICAgICAgICBsYXN0VGltZTogMCwNCiAgICAgICAgICAgIHRpbWVyOiAwLA0KICAgICAgICAgICAgaW50ZXJ2YWw6IDEwMDANCiAgICAgICAgfQ0KICAgIH0sDQogICAgZmlsdGVyczogew0KICAgICAgICBmb3JtYXQodGltZSkgew0KICAgICAgICAgICAgY29uc3QgaG91cnMgPSA2MCAqIDYwICogMTAwMA0KICAgICAgICAgICAgY29uc3QgbWludXRlcyA9IDYwICogMTAwMA0KDQogICAgICAgICAgICBjb25zdCBoID0gTWF0aC5mbG9vcih0aW1lIC8gaG91cnMpDQogICAgICAgICAgICBjb25zdCBtID0gTWF0aC5mbG9vcigodGltZSAtIGggKiBob3VycykgLyBtaW51dGVzKQ0KICAgICAgICAgICAgY29uc3QgcyA9IE1hdGguZmxvb3IoKHRpbWUgLSBoICogaG91cnMgLSBtICogbWludXRlcykgLyAxMDAwKQ0KICAgICAgICAgICAgcmV0dXJuIGAke2ZpeGVkWmVybyhoKX06JHtmaXhlZFplcm8obSl9OiR7Zml4ZWRaZXJvKHMpfWANCiAgICAgICAgfQ0KICAgIH0sDQogICAgY3JlYXRlZCgpIHsNCiAgICAgICAgdGhpcy5pbml0VGltZSgpDQogICAgICAgIHRoaXMudGljaygpDQogICAgfSwNCiAgICBtZXRob2RzOiB7DQogICAgICAgIGluaXRUaW1lKCkgew0KICAgICAgICAgICAgbGV0IGxhc3RUaW1lID0gMA0KICAgICAgICAgICAgbGV0IHRhcmdldFRpbWUgPSAwDQogICAgICAgICAgICB0aGlzLm9yaWdpblRhcmdldFRpbWUgPSB0aGlzLnRhcmdldA0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHRoaXMudGFyZ2V0KSA9PT0gJ1tvYmplY3QgRGF0ZV0nKSB7DQogICAgICAgICAgICAgICAgICAgIHRhcmdldFRpbWUgPSB0aGlzLnRhcmdldA0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHRhcmdldFRpbWUgPSBuZXcgRGF0ZSh0aGlzLnRhcmdldCkuZ2V0VGltZSgpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignaW52YWxpZCB0YXJnZXQgcHJvcCcpDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGxhc3RUaW1lID0gdGFyZ2V0VGltZSAtIG5ldyBEYXRlKCkuZ2V0VGltZSgpDQoNCiAgICAgICAgICAgIHRoaXMubGFzdFRpbWUgPSBsYXN0VGltZSA8IDAgPyAwIDogbGFzdFRpbWUNCiAgICAgICAgfSwNCiAgICAgICAgdGljaygpIHsNCiAgICAgICAgICAgIGNvbnN0IHsgb25FbmQgfSA9IHRoaXMNCg0KICAgICAgICAgICAgdGhpcy50aW1lciA9IHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICAgICAgICAgIGlmICh0aGlzLmxhc3RUaW1lIDwgdGhpcy5pbnRlcnZhbCkgew0KICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lcikNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5sYXN0VGltZSA9IDANCiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBvbkVuZCA9PT0gJ2Z1bmN0aW9uJykgew0KICAgICAgICAgICAgICAgICAgICAgICAgb25FbmQoKQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5sYXN0VGltZSAtPSB0aGlzLmludGVydmFsDQogICAgICAgICAgICAgICAgICAgIHRoaXMudGljaygpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwgdGhpcy5pbnRlcnZhbCkNCiAgICAgICAgfQ0KICAgIH0sDQogICAgYmVmb3JlVXBkYXRlKCkgew0KICAgICAgICBpZiAodGhpcy5vcmlnaW5UYXJnZXRUaW1lICE9PSB0aGlzLnRhcmdldCkgew0KICAgICAgICAgICAgdGhpcy5pbml0VGltZSgpDQogICAgICAgIH0NCiAgICB9LA0KICAgIGJlZm9yZURlc3Ryb3koKSB7DQogICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVyKQ0KICAgIH0NCn0NCg=="},{"version":3,"sources":["CountDown.vue"],"names":[],"mappings":";;;;;AAKA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CountDown.vue","sourceRoot":"src/components/CountDown","sourcesContent":["<template>\r\n  <span>{{ lastTime | format }}</span>\r\n</template>\r\n\r\n<script>\r\nfunction fixedZero(val) {\r\n    return val * 1 < 10 ? `0${val}` : val\r\n}\r\n\r\nexport default {\r\n    name: 'CountDown',\r\n    props: {\r\n        format: {\r\n            type: Function,\r\n            default: undefined\r\n        },\r\n        target: {\r\n            type: [Date, Number],\r\n            required: true\r\n        },\r\n        onEnd: {\r\n            type: Function,\r\n            default: () => ({})\r\n        }\r\n    },\r\n    data() {\r\n        return {\r\n            dateTime: '0',\r\n            originTargetTime: 0,\r\n            lastTime: 0,\r\n            timer: 0,\r\n            interval: 1000\r\n        }\r\n    },\r\n    filters: {\r\n        format(time) {\r\n            const hours = 60 * 60 * 1000\r\n            const minutes = 60 * 1000\r\n\r\n            const h = Math.floor(time / hours)\r\n            const m = Math.floor((time - h * hours) / minutes)\r\n            const s = Math.floor((time - h * hours - m * minutes) / 1000)\r\n            return `${fixedZero(h)}:${fixedZero(m)}:${fixedZero(s)}`\r\n        }\r\n    },\r\n    created() {\r\n        this.initTime()\r\n        this.tick()\r\n    },\r\n    methods: {\r\n        initTime() {\r\n            let lastTime = 0\r\n            let targetTime = 0\r\n            this.originTargetTime = this.target\r\n            try {\r\n                if (Object.prototype.toString.call(this.target) === '[object Date]') {\r\n                    targetTime = this.target\r\n                } else {\r\n                    targetTime = new Date(this.target).getTime()\r\n                }\r\n            } catch (e) {\r\n                throw new Error('invalid target prop')\r\n            }\r\n\r\n            lastTime = targetTime - new Date().getTime()\r\n\r\n            this.lastTime = lastTime < 0 ? 0 : lastTime\r\n        },\r\n        tick() {\r\n            const { onEnd } = this\r\n\r\n            this.timer = setTimeout(() => {\r\n                if (this.lastTime < this.interval) {\r\n                    clearTimeout(this.timer)\r\n                    this.lastTime = 0\r\n                    if (typeof onEnd === 'function') {\r\n                        onEnd()\r\n                    }\r\n                } else {\r\n                    this.lastTime -= this.interval\r\n                    this.tick()\r\n                }\r\n            }, this.interval)\r\n        }\r\n    },\r\n    beforeUpdate() {\r\n        if (this.originTargetTime !== this.target) {\r\n            this.initTime()\r\n        }\r\n    },\r\n    beforeDestroy() {\r\n        clearTimeout(this.timer)\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n</style>\r\n"]}]}