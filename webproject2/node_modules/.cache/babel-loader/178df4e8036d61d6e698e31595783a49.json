{"remainingRequest":"E:\\ideas-test\\webproject\\node_modules\\babel-loader\\lib\\index.js!E:\\ideas-test\\webproject\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!E:\\ideas-test\\webproject\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\ideas-test\\webproject\\src\\components\\CountDown\\CountDown.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\ideas-test\\webproject\\src\\components\\CountDown\\CountDown.vue","mtime":1587193626000},{"path":"E:\\ideas-test\\webproject\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1655196103443},{"path":"E:\\ideas-test\\webproject\\node_modules\\babel-loader\\lib\\index.js","mtime":1655196104199},{"path":"E:\\ideas-test\\webproject\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1655196103443},{"path":"E:\\ideas-test\\webproject\\node_modules\\vue-loader\\lib\\index.js","mtime":1655196105141}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubnVtYmVyLmNvbnN0cnVjdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CgovLwovLwovLwovLwpmdW5jdGlvbiBmaXhlZFplcm8odmFsKSB7CiAgcmV0dXJuIHZhbCAqIDEgPCAxMCA/ICIwIi5jb25jYXQodmFsKSA6IHZhbDsKfQoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdDb3VudERvd24nLAogIHByb3BzOiB7CiAgICBmb3JtYXQ6IHsKICAgICAgdHlwZTogRnVuY3Rpb24sCiAgICAgIGRlZmF1bHQ6IHVuZGVmaW5lZAogICAgfSwKICAgIHRhcmdldDogewogICAgICB0eXBlOiBbRGF0ZSwgTnVtYmVyXSwKICAgICAgcmVxdWlyZWQ6IHRydWUKICAgIH0sCiAgICBvbkVuZDogewogICAgICB0eXBlOiBGdW5jdGlvbiwKICAgICAgZGVmYXVsdDogZnVuY3Rpb24gX2RlZmF1bHQoKSB7CiAgICAgICAgcmV0dXJuIHt9OwogICAgICB9CiAgICB9CiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZGF0ZVRpbWU6ICcwJywKICAgICAgb3JpZ2luVGFyZ2V0VGltZTogMCwKICAgICAgbGFzdFRpbWU6IDAsCiAgICAgIHRpbWVyOiAwLAogICAgICBpbnRlcnZhbDogMTAwMAogICAgfTsKICB9LAogIGZpbHRlcnM6IHsKICAgIGZvcm1hdDogZnVuY3Rpb24gZm9ybWF0KHRpbWUpIHsKICAgICAgdmFyIGhvdXJzID0gNjAgKiA2MCAqIDEwMDA7CiAgICAgIHZhciBtaW51dGVzID0gNjAgKiAxMDAwOwogICAgICB2YXIgaCA9IE1hdGguZmxvb3IodGltZSAvIGhvdXJzKTsKICAgICAgdmFyIG0gPSBNYXRoLmZsb29yKCh0aW1lIC0gaCAqIGhvdXJzKSAvIG1pbnV0ZXMpOwogICAgICB2YXIgcyA9IE1hdGguZmxvb3IoKHRpbWUgLSBoICogaG91cnMgLSBtICogbWludXRlcykgLyAxMDAwKTsKICAgICAgcmV0dXJuICIiLmNvbmNhdChmaXhlZFplcm8oaCksICI6IikuY29uY2F0KGZpeGVkWmVybyhtKSwgIjoiKS5jb25jYXQoZml4ZWRaZXJvKHMpKTsKICAgIH0KICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmluaXRUaW1lKCk7CiAgICB0aGlzLnRpY2soKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGluaXRUaW1lOiBmdW5jdGlvbiBpbml0VGltZSgpIHsKICAgICAgdmFyIGxhc3RUaW1lID0gMDsKICAgICAgdmFyIHRhcmdldFRpbWUgPSAwOwogICAgICB0aGlzLm9yaWdpblRhcmdldFRpbWUgPSB0aGlzLnRhcmdldDsKCiAgICAgIHRyeSB7CiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0aGlzLnRhcmdldCkgPT09ICdbb2JqZWN0IERhdGVdJykgewogICAgICAgICAgdGFyZ2V0VGltZSA9IHRoaXMudGFyZ2V0OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0YXJnZXRUaW1lID0gbmV3IERhdGUodGhpcy50YXJnZXQpLmdldFRpbWUoKTsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2ludmFsaWQgdGFyZ2V0IHByb3AnKTsKICAgICAgfQoKICAgICAgbGFzdFRpbWUgPSB0YXJnZXRUaW1lIC0gbmV3IERhdGUoKS5nZXRUaW1lKCk7CiAgICAgIHRoaXMubGFzdFRpbWUgPSBsYXN0VGltZSA8IDAgPyAwIDogbGFzdFRpbWU7CiAgICB9LAogICAgdGljazogZnVuY3Rpb24gdGljaygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBvbkVuZCA9IHRoaXMub25FbmQ7CiAgICAgIHRoaXMudGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAoX3RoaXMubGFzdFRpbWUgPCBfdGhpcy5pbnRlcnZhbCkgewogICAgICAgICAgY2xlYXJUaW1lb3V0KF90aGlzLnRpbWVyKTsKICAgICAgICAgIF90aGlzLmxhc3RUaW1lID0gMDsKCiAgICAgICAgICBpZiAodHlwZW9mIG9uRW5kID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgIG9uRW5kKCk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIF90aGlzLmxhc3RUaW1lIC09IF90aGlzLmludGVydmFsOwoKICAgICAgICAgIF90aGlzLnRpY2soKTsKICAgICAgICB9CiAgICAgIH0sIHRoaXMuaW50ZXJ2YWwpOwogICAgfQogIH0sCiAgYmVmb3JlVXBkYXRlOiBmdW5jdGlvbiBiZWZvcmVVcGRhdGUoKSB7CiAgICBpZiAodGhpcy5vcmlnaW5UYXJnZXRUaW1lICE9PSB0aGlzLnRhcmdldCkgewogICAgICB0aGlzLmluaXRUaW1lKCk7CiAgICB9CiAgfSwKICBiZWZvcmVEZXN0cm95OiBmdW5jdGlvbiBiZWZvcmVEZXN0cm95KCkgewogICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZXIpOwogIH0KfTs="},{"version":3,"mappings":";;;;;;;;AAKA;AACA;AACA;;AAEA;AACAA,mBADA;AAEAC;AACAC;AACAC,oBADA;AAEAC;AAFA,KADA;AAKAC;AACAF,0BADA;AAEAG;AAFA,KALA;AASAC;AACAJ,oBADA;AAEAC;AAAA;AAAA;AAFA;AATA,GAFA;AAgBAI,MAhBA,kBAgBA;AACA;AACAC,mBADA;AAEAC,yBAFA;AAGAC,iBAHA;AAIAC,cAJA;AAKAC;AALA;AAOA,GAxBA;AAyBAC;AACAZ,UADA,kBACAa,IADA,EACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AATA,GAzBA;AAoCAC,SApCA,qBAoCA;AACA;AACA;AACA,GAvCA;AAwCAC;AACAC,YADA,sBACA;AACA;AACA;AACA;;AACA;AACA;AACAC;AACA,SAFA,MAEA;AACAA;AACA;AACA,OANA,CAMA;AACA;AACA;;AAEAR;AAEA;AACA,KAlBA;AAmBAS,QAnBA,kBAmBA;AAAA;;AACA;AAEA;AACA;AACAC;AACA;;AACA;AACAd;AACA;AACA,SANA,MAMA;AACA;;AACA;AACA;AACA,OAXA,EAWA,aAXA;AAYA;AAlCA,GAxCA;AA4EAe,cA5EA,0BA4EA;AACA;AACA;AACA;AACA,GAhFA;AAiFAC,eAjFA,2BAiFA;AACAF;AACA;AAnFA","names":["name","props","format","type","default","target","required","onEnd","data","dateTime","originTargetTime","lastTime","timer","interval","filters","time","created","methods","initTime","targetTime","tick","clearTimeout","beforeUpdate","beforeDestroy"],"sourceRoot":"src/components/CountDown","sources":["CountDown.vue"],"sourcesContent":["<template>\r\n  <span>{{ lastTime | format }}</span>\r\n</template>\r\n\r\n<script>\r\nfunction fixedZero(val) {\r\n    return val * 1 < 10 ? `0${val}` : val\r\n}\r\n\r\nexport default {\r\n    name: 'CountDown',\r\n    props: {\r\n        format: {\r\n            type: Function,\r\n            default: undefined\r\n        },\r\n        target: {\r\n            type: [Date, Number],\r\n            required: true\r\n        },\r\n        onEnd: {\r\n            type: Function,\r\n            default: () => ({})\r\n        }\r\n    },\r\n    data() {\r\n        return {\r\n            dateTime: '0',\r\n            originTargetTime: 0,\r\n            lastTime: 0,\r\n            timer: 0,\r\n            interval: 1000\r\n        }\r\n    },\r\n    filters: {\r\n        format(time) {\r\n            const hours = 60 * 60 * 1000\r\n            const minutes = 60 * 1000\r\n\r\n            const h = Math.floor(time / hours)\r\n            const m = Math.floor((time - h * hours) / minutes)\r\n            const s = Math.floor((time - h * hours - m * minutes) / 1000)\r\n            return `${fixedZero(h)}:${fixedZero(m)}:${fixedZero(s)}`\r\n        }\r\n    },\r\n    created() {\r\n        this.initTime()\r\n        this.tick()\r\n    },\r\n    methods: {\r\n        initTime() {\r\n            let lastTime = 0\r\n            let targetTime = 0\r\n            this.originTargetTime = this.target\r\n            try {\r\n                if (Object.prototype.toString.call(this.target) === '[object Date]') {\r\n                    targetTime = this.target\r\n                } else {\r\n                    targetTime = new Date(this.target).getTime()\r\n                }\r\n            } catch (e) {\r\n                throw new Error('invalid target prop')\r\n            }\r\n\r\n            lastTime = targetTime - new Date().getTime()\r\n\r\n            this.lastTime = lastTime < 0 ? 0 : lastTime\r\n        },\r\n        tick() {\r\n            const { onEnd } = this\r\n\r\n            this.timer = setTimeout(() => {\r\n                if (this.lastTime < this.interval) {\r\n                    clearTimeout(this.timer)\r\n                    this.lastTime = 0\r\n                    if (typeof onEnd === 'function') {\r\n                        onEnd()\r\n                    }\r\n                } else {\r\n                    this.lastTime -= this.interval\r\n                    this.tick()\r\n                }\r\n            }, this.interval)\r\n        }\r\n    },\r\n    beforeUpdate() {\r\n        if (this.originTargetTime !== this.target) {\r\n            this.initTime()\r\n        }\r\n    },\r\n    beforeDestroy() {\r\n        clearTimeout(this.timer)\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n</style>\r\n"]}]}